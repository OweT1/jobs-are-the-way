name: Hourly Message job - DEV

on:
  workflow_dispatch: # Allows to run the script manually for testing

jobs:
  run-script:
    runs-on: ubuntu-latest # Specifies the runner environment
    environment: develop

    env:
      ENVRIONMENT_NAME: ${{ vars.ENVIRONMENT_NAME }}
      OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
      OPENROUTER_BASE_URL: ${{ vars.OPENROUTER_BASE_URL }}
      HOURS_OLD: ${{ vars.HOURS_OLD }}
      DEFAULT_LOCATION: ${{ vars.DEFAULT_LOCATION }}
      TELEGRAM_BOT_API: ${{ secrets.TELEGRAM_BOT_API }}
      TELEGRAM_CHANNEL_ID: ${{ secrets.TELEGRAM_CHANNEL_ID }}
      AIML_ENGINEER_THREAD_ID: ${{ vars.AIML_ENGINEER_THREAD_ID }}
      DATA_ENGINEER_THREAD_ID: ${{ vars.DATA_ENGINEER_THREAD_ID}}
      DATA_SCIENTIST_THREAD_ID: ${{ vars.DATA_SCIENTIST_THREAD_ID }}
      DATA_ANALYST_THREAD_ID: ${{ vars.DATA_ANALYST_THREAD_ID }}
      OTHERS_THREAD_ID: ${{ vars.OTHERS_THREAD_ID }}
      AIML_ENGINEER_INTERN_THREAD_ID: ${{ vars.AIML_ENGINEER_INTERN_THREAD_ID }}
      DATA_ENGINEER_INTERN_THREAD_ID: ${{ vars.DATA_ENGINEER_INTERN_THREAD_ID}}
      DATA_SCIENTIST_INTERN_THREAD_ID: ${{ vars.DATA_SCIENTIST_INTERN_THREAD_ID }}
      DATA_ANALYST_INTERN_THREAD_ID: ${{ vars.DATA_ANALYST_INTERN_THREAD_ID }}
      OTHERS_INTERN_THREAD_ID: ${{ vars.OTHERS_INTERN_THREAD_ID }}
      SENIOR_TECH_THREAD_ID: ${{ vars.SENIOR_TECH_THREAD_ID }}
      NOT_RELEVANT_THREAD_ID: ${{ vars.NOT_RELEVANT_THREAD_ID }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4 # Action to check out repository code

      - name: Install uv
        uses: astral-sh/setup-uv@v5
        with:
          enable-cache: true # Uses GitHub's cache for uv dependencies automatically
          version: "latest"

      - name: Set up Python
        run: uv python install 3.13

      - name: Run Script
        run: uv run python -m src.main # 'uv run' automatically handles environment syncing and running the module
